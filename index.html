<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Impostor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0f1117;
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}
.container {
    width: 360px;
    background: #1a1d27;
    padding: 25px;
    border-radius: 14px;
    box-shadow: 0 0 30px rgba(0,0,0,0.6);
    text-align: center;
}
h1 {
    margin-top: 0;
}
button {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    border: none;
    border-radius: 8px;
    background: #4c6ef5;
    color: white;
    font-size: 16px;
    cursor: pointer;
}
button:hover {
    background: #3b5bdb;
}
input {
    width: 100%;
    padding: 10px;
    margin-top: 10px;
    border-radius: 6px;
    border: none;
    background: #2a2f3d;
    color: white;
}
.player-list {
    text-align: left;
    margin-top: 15px;
    background: #11131a;
    padding: 10px;
    border-radius: 8px;
    max-height: 150px;
    overflow-y: auto;
}
.code {
    font-size: 28px;
    letter-spacing: 4px;
    margin: 10px 0;
}
.word {
    font-size: 28px;
    margin-top: 20px;
}
.impostor {
    color: #ff4d4d;
}
.hidden {
    display: none;
}
</style>
</head>
<body>

<div class="container" id="app">

    <!-- MENU -->
    <div id="menu">
        <h1>IMPOSTOR</h1>
        <button onclick="showCreate()">Stwórz grę</button>
        <button onclick="showJoin()">Dołącz do gry</button>
    </div>

    <!-- CREATE -->
    <div id="create" class="hidden">
        <h2>Twoja nazwa</h2>
        <input id="createName" placeholder="Nazwa gracza">
        <h3>Tryb gry</h3>
        <button onclick="createGame('classic')">Klasyczna gra</button>
        <button onclick="createGame('hint')">Gra z podpowiedzią</button>
    </div>

    <!-- JOIN -->
    <div id="join" class="hidden">
        <h2>Dołącz do gry</h2>
        <input id="joinName" placeholder="Nazwa gracza">
        <input id="joinCode" placeholder="Kod lobby">
        <button onclick="joinGame()">Dołącz</button>
    </div>

    <!-- LOBBY -->
    <div id="lobby" class="hidden">
        <h2>Kod gry</h2>
        <div class="code" id="lobbyCode"></div>

        <div class="player-list" id="players"></div>

        <button id="startBtn" onclick="startGame()">Start</button>
        <button onclick="leaveGame()">Opuść</button>
    </div>

    <!-- GAME -->
    <div id="game" class="hidden">
        <h2>Twoja rola</h2>
        <div class="word" id="word"></div>

        <button id="newRoundBtn" onclick="newRound()">Nowa runda</button>
        <button onclick="leaveGame()">Opuść</button>
    </div>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>

const firebaseConfig = {
  apiKey: "AIzaSyAcNOpg3tuY_xhbERC-l3ieWo-qsUoDYxE",
  authDomain: "impostor-4c89d.firebaseapp.com",
  databaseURL: "https://impostor-4c89d-default-rtdb.firebaseio.com",
  projectId: "impostor-4c89d",
  storageBucket: "impostor-4c89d.firebasestorage.app",
  messagingSenderId: "666744045134",
  appId: "1:666744045134:web:f19514b88188ab4ff24d1f"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();


// === DANE LOKALNE ===
let playerId = Math.random().toString(36).substr(2, 9);
let playerName = "";
let lobbyId = "";
let isHost = false;
let gameMode = "classic";

// Słowa testowe
const words = [
/* OSOBY */ {word:"Robert Lewandowski", hint:"Napastnik"}, {word:"Michael Jackson", hint:"Taniec"}, {word:"Albert Einstein", hint:"Geniusz"}, {word:"Elon Musk", hint:"Rakiety"}, {word:"Taylor Swift", hint:"Koncert"}, {word:"Harry Potter", hint:"Magia"}, {word:"Spider-Man", hint:"Pajęczyna"}, {word:"Batman", hint:"Mrok"}, {word:"Sherlock Holmes", hint:"Detektyw"}, {word:"Pikachu", hint:"Elektryczność"}, /* MIEJSCA */ {word:"Nowy Jork", hint:"Drapacze"}, {word:"Paryż", hint:"Romantycznie"}, {word:"Bałtyk", hint:"Polska"}, {word:"Tatry", hint:"Wspinaczka"}, {word:"Sahara", hint:"Upał"}, {word:"Amazonia", hint:"Dżungla"}, {word:"Tokio", hint:"Neony"}, {word:"Londyn", hint:"Deszcz"}, {word:"Rzym", hint:"Historia"}, {word:"Las Vegas", hint:"Kasyno"}, /* FILMY I SERIALE */ {word:"Gra o Tron", hint:"Władza"}, {word:"Władca Pierścieni", hint:"Podróż"}, {word:"Star Wars", hint:"Kosmos"}, {word:"Matrix", hint:"Symulacja"}, {word:"Titanic", hint:"Katastrofa"}, {word:"Avatar", hint:"Natura"}, {word:"Jurassic Park", hint:"Dinozaury"}, {word:"Stranger Things", hint:"Tajemnica"}, {word:"Breaking Bad", hint:"Chemia"}, {word:"The Office", hint:"Biuro"}, /* PRZEDMIOTY */ {word:"Smartfon", hint:"Powiadomienia"}, {word:"Laptop", hint:"Praca"}, {word:"Kamera", hint:"Nagranie"}, {word:"Zegarek", hint:"Czas"}, {word:"Plecak", hint:"Podróż"}, {word:"Walizka", hint:"Lotnisko"}, {word:"Latarka", hint:"Ciemność"}, {word:"Parasol", hint:"Pogoda"}, {word:"Okulary", hint:"Wzrok"}, {word:"Słuchawki", hint:"Muzyka"}, /* JEDZENIE */ {word:"Pizza", hint:"Dostawa"}, {word:"Sushi", hint:"Japonia"}, {word:"Burger", hint:"Fast food"}, {word:"Lody", hint:"Lato"}, {word:"Czekolada", hint:"Słodkie"}, {word:"Kawa", hint:"Pobudka"}, {word:"Herbata", hint:"Spokój"}, {word:"Popcorn", hint:"Kino"}, {word:"Makaron", hint:"Włochy"}, {word:"Tort", hint:"Urodziny"}, /* ZWIERZĘTA */ {word:"Lew", hint:"Król"}, {word:"Tygrys", hint:"Dżungla"}, {word:"Delfin", hint:"Inteligencja"}, {word:"Rekin", hint:"Strach"}, {word:"Orzeł", hint:"Wysoko"}, {word:"Pingwin", hint:"Lód"}, {word:"Koń", hint:"Galop"}, {word:"Panda", hint:"Bambus"}, {word:"Wilk", hint:"Stado"}, {word:"Niedźwiedź", hint:"Sen zimowy"}, /* SPORT */ {word:"Piłka nożna", hint:"Gol"}, {word:"Koszykówka", hint:"Rzut"}, {word:"Siatkówka", hint:"Drużyna"}, {word:"Tenis", hint:"Kort"}, {word:"Formuła 1", hint:"Prędkość"}, {word:"Boks", hint:"Runda"}, {word:"Maraton", hint:"Wytrzymałość"}, {word:"Narciarstwo", hint:"Zima"}, {word:"Surfing", hint:"Fale"}, {word:"Szachy", hint:"Strategia"}, /* EMOCJE I POJĘCIA */ {word:"Miłość", hint:"Relacja"}, {word:"Strach", hint:"Napięcie"}, {word:"Sukces", hint:"Osiągnięcie"}, {word:"Porażka", hint:"Lekcja"}, {word:"Marzenie", hint:"Cel"}, {word:"Tajemnica", hint:"Ukryte"}, {word:"Chaos", hint:"Bałagan"}, {word:"Spokój", hint:"Cisza"}, {word:"Przygoda", hint:"Podróż"}, {word:"Ryzyko", hint:"Decyzja"}, /* OSOBY */
{word:"Cristiano Ronaldo", hint:"Rekordy"},
{word:"Lionel Messi", hint:"Drybling"},
{word:"Iga Świątek", hint:"Kort ziemny"},
{word:"Andrzej Sapkowski", hint:"Wiedźmin"},
{word:"Stephen King", hint:"Groza"},
{word:"J.K. Rowling", hint:"Szkoła magii"},
{word:"Leonardo da Vinci", hint:"Renesans"},
{word:"Frida Kahlo", hint:"Autoportret"},
{word:"Walt Disney", hint:"Animacja"},
{word:"Freddie Mercury", hint:"Scena"},
{word:"Bruce Lee", hint:"Sztuki walki"},
{word:"Arnold Schwarzenegger", hint:"Kulturystyka"},
{word:"Tom Hanks", hint:"Hollywood"},
{word:"Keanu Reeves", hint:"Matrix aktor"},
{word:"Emma Watson", hint:"Hermiona"},
{word:"Scarlett Johansson", hint:"Marvel"},
{word:"Ryan Reynolds", hint:"Deadpool"},
{word:"Robert Downey Jr.", hint:"Iron Man"},
{word:"Chris Hemsworth", hint:"Thor"},
{word:"Dwayne Johnson", hint:"The Rock"},

/* MIEJSCA */
{word:"Sydney", hint:"Opera"},
{word:"Dubaj", hint:"Wieżowce"},
{word:"Los Angeles", hint:"Filmy"},
{word:"San Francisco", hint:"Most"},
{word:"Chicago", hint:"Wiatr"},
{word:"Berlin", hint:"Mur"},
{word:"Praga", hint:"Most Karola"},
{word:"Wenecja", hint:"Kanały"},
{word:"Barcelona", hint:"Gaudi"},
{word:"Madryt", hint:"Hiszpania stolica"},
{word:"Hawaje", hint:"Wulkany"},
{word:"Islandia", hint:"Gejzery"},
{word:"Alpy", hint:"Narty"},
{word:"Mount Everest", hint:"Szczyt"},
{word:"Niagara", hint:"Wodospad"},
{word:"Wielki Kanion", hint:"Przepaść"},
{word:"Antarktyda", hint:"Ekspedycja"},
{word:"Grenlandia", hint:"Lód"},
{word:"Malediwy", hint:"Rafa"},
{word:"Bali", hint:"Relaks"},

/* FILMY I SERIALE */
{word:"Avengers", hint:"Superbohaterowie razem"},
{word:"Iron Man", hint:"Zbroja"},
{word:"Thor", hint:"Młot"},
{word:"Hulk", hint:"Siła"},
{word:"Deadpool", hint:"Humor"},
{word:"Joker", hint:"Chaos"},
{word:"Incepcja", hint:"Sny"},
{word:"Interstellar", hint:"Czasoprzestrzeń"},
{word:"Gladiator", hint:"Arena"},
{word:"Piraci z Karaibów", hint:"Morze"},
{word:"Szybcy i wściekli", hint:"Wyścigi"},
{word:"John Wick", hint:"Zemsta"},
{word:"The Crown", hint:"Rodzina królewska"},
{word:"Narcos", hint:"Kartel"},
{word:"Dark", hint:"Pętle czasowe"},
{word:"The Witcher", hint:"Potwory"},
{word:"Wednesday", hint:"Gotyk"},
{word:"Peaky Blinders", hint:"Gang"},
{word:"House of the Dragon", hint:"Smoki"},
{word:"Black Mirror", hint:"Technologia"},

/* PRZEDMIOTY */
{word:"Powerbank", hint:"Energia w podróży"},
{word:"Tablet", hint:"Dotykowy ekran"},
{word:"Drukarka", hint:"Papier"},
{word:"Klawiatura", hint:"Pisanie"},
{word:"Myszka", hint:"Kursor"},
{word:"Monitor", hint:"Wyświetlanie"},
{word:"Router", hint:"Internet domowy"},
{word:"Pilot", hint:"Kanały"},
{word:"Głośnik", hint:"Dźwięk"},
{word:"Mikrofon", hint:"Nagrywanie"},
{word:"Statyw", hint:"Stabilność"},
{word:"Termos", hint:"Ciepło długo"},
{word:"Bidon", hint:"Sport"},
{word:"Scyzoryk", hint:"Wielofunkcyjny"},
{word:"Kompas", hint:"Kierunek"},
{word:"Mapa", hint:"Orientacja"},
{word:"Notes", hint:"Zapisy"},
{word:"Długopis", hint:"Atrament"},
{word:"Kalkulator", hint:"Obliczenia"},
{word:"Latte art", hint:"Kawiarnia"},

/* JEDZENIE */
{word:"Tacos", hint:"Meksyk"},
{word:"Burrito", hint:"Zawinięte"},
{word:"Ramen", hint:"Bulion"},
{word:"Pad Thai", hint:"Tajlandia"},
{word:"Pierogi", hint:"Polska kuchnia"},
{word:"Gołąbki", hint:"Kapusta"},
{word:"Schabowy", hint:"Panierka"},
{word:"Żurek", hint:"Kwaśny"},
{word:"Barszcz", hint:"Buraki"},
{word:"Kebab", hint:"Nocne jedzenie"},
{word:"Falafel", hint:"Ciecierzyca"},
{word:"Hummus", hint:"Pasta"},
{word:"Guacamole", hint:"Awokado"},
{word:"Nachosy", hint:"Sos serowy"},
{word:"Croissant", hint:"Francja"},
{word:"Bagietka", hint:"Długa bułka"},
{word:"Pączki", hint:"Tłusty czwartek"},
{word:"Muffin", hint:"Papierowa foremka"},
{word:"Smoothie", hint:"Blendowane"},
{word:"Milkshake", hint:"Gęsty napój"},

/* ZWIERZĘTA */
{word:"Słoń", hint:"Pamięć"},
{word:"Żyrafa", hint:"Długa szyja"},
{word:"Kangur", hint:"Torba"},
{word:"Koala", hint:"Eukaliptus"},
{word:"Hipopotam", hint:"Rzeka"},
{word:"Nosorożec", hint:"Róg"},
{word:"Gepard", hint:"Najszybszy"},
{word:"Pantera", hint:"Cichy łowca"},
{word:"Lis", hint:"Spryt"},
{word:"Sowa", hint:"Noc"},
{word:"Jastrząb", hint:"Polowanie z powietrza"},
{word:"Kruk", hint:"Czarny ptak"},
{word:"Flaming", hint:"Różowy"},
{word:"Aligator", hint:"Bagna"},
{word:"Kameleon", hint:"Zmiana koloru"},
{word:"Ośmiornica", hint:"Ramiona"},
{word:"Meduza", hint:"Parzy"},
{word:"Konik morski", hint:"Ocean"},
{word:"Foka", hint:"Wybrzeże"},
{word:"Mors", hint:"Kły"},

/* SPORT */
{word:"Triathlon", hint:"Trzy dyscypliny"},
{word:"Crossfit", hint:"Obwody"},
{word:"Kalistenika", hint:"Masa ciała"},
{word:"Podnoszenie ciężarów", hint:"Sztanga"},
{word:"Judo", hint:"Rzut"},
{word:"Karate", hint:"Pas"},
{word:"Taekwondo", hint:"Kopnięcia"},
{word:"Wspinaczka", hint:"Chwyty"},
{word:"Bouldering", hint:"Nisko bez liny"},
{word:"Hokej", hint:"Lód"},
{word:"Łyżwiarstwo", hint:"Ślizg"},
{word:"Snowboard", hint:"Deska zimą"},
{word:"Skateboarding", hint:"Triki"},
{word:"Parkour", hint:"Miasto"},
{word:"Strzelectwo", hint:"Celność"},
{word:"Golf", hint:"Dołki"},
{word:"Baseball", hint:"Kij"},
{word:"Rugby", hint:"Owalna piłka"},
{word:"Badminton", hint:"Lotka"},
{word:"Tenis stołowy", hint:"Ping-pong"},

/* EMOCJE I POJĘCIA */
{word:"Motywacja", hint:"Działanie"},
{word:"Determinacja", hint:"Upór"},
{word:"Cierpliwość", hint:"Czekanie"},
{word:"Wdzięczność", hint:"Docenianie"},
{word:"Zazdrość", hint:"Porównania"},
{word:"Duma", hint:"Satysfakcja"},
{word:"Wstyd", hint:"Zakłopotanie"},
{word:"Nostalgia", hint:"Wspomnienia"},
{word:"Ekscytacja", hint:"Oczekiwanie"},
{word:"Zaskoczenie", hint:"Niespodzianka"},
{word:"Rozczarowanie", hint:"Zawód"},
{word:"Ulga", hint:"Po stresie"},
{word:"Samotność", hint:"Brak ludzi"},
{word:"Zaufanie", hint:"Wiara w kogoś"},
{word:"Odwaga", hint:"Ryzyko działania"},
{word:"Kreatywność", hint:"Pomysły"},
{word:"Ambicja", hint:"Wysokie cele"},
{word:"Koncentracja", hint:"Skupienie"},
{word:"Równowaga", hint:"Stabilność"},
{word:"Wyobraźnia", hint:"Tworzenie w głowie"} ];

// UI helpers
function show(id){
    document.querySelectorAll(".container > div").forEach(d=>d.classList.add("hidden"));
    document.getElementById(id).classList.remove("hidden");
}

// MENU
function showCreate(){ show("create"); }
function showJoin(){ show("join"); }

// GENERUJ KOD
function generateCode(){
    return Math.floor(100000 + Math.random()*900000).toString();
}

// CREATE GAME
function createGame(mode){
    playerName = document.getElementById("createName").value;
    if(!playerName) return;

    gameMode = mode;
    lobbyId = generateCode();
    isHost = true;

    db.ref("lobbies/"+lobbyId).set({
        host: playerId,
        state: "lobby",
        mode: gameMode
    });

    db.ref("lobbies/"+lobbyId+"/players/"+playerId).set({
        name: playerName
    });

    enterLobby();
}

// JOIN GAME
function joinGame(){
    playerName = document.getElementById("joinName").value;
    lobbyId = document.getElementById("joinCode").value;

    if(!playerName || !lobbyId) return;

    db.ref("lobbies/"+lobbyId).once("value", snap=>{
        if(!snap.exists()){
            alert("Lobby nie istnieje!");
            return;
        }

        db.ref("lobbies/"+lobbyId+"/players/"+playerId).set({
            name: playerName
        });

        enterLobby();
    });
}

// LOBBY
function enterLobby(){
    show("lobby");
    document.getElementById("lobbyCode").innerText = lobbyId;

    db.ref("lobbies/"+lobbyId+"/players").on("value", snap=>{
        let html="";
        snap.forEach(p=>{
            html += p.val().name + "<br>";
        });
        document.getElementById("players").innerHTML = html;
    });

 db.ref("lobbies/"+lobbyId).on("value", snap=>{
    let data = snap.val();
    if(!data) return;

    if(data.state === "game"){
        startGameView(data);
    }
});

    document.getElementById("startBtn").style.display = isHost ? "block" : "none";
}

// START GAME
function startGame(){
    if(!isHost) return;
    newRound();
}

function newRound(){

    if(!isHost) return;

    db.ref("lobbies/"+lobbyId).once("value", lobbySnap=>{

        if(!lobbySnap.exists()){
            alert("Lobby nie istnieje");
            return;
        }

        let lobbyData = lobbySnap.val();
        let mode = lobbyData.mode || "classic";

        db.ref("lobbies/"+lobbyId+"/players").once("value", snap=>{

            if(!snap.exists()){
                alert("Brak graczy!");
                return;
            }

            let players = [];
            snap.forEach(p => players.push(p.key));

            if(players.length < 2){
                alert("Potrzeba minimum 2 graczy!");
                return;
            }

            let impostor = players[Math.floor(Math.random()*players.length)];
            let selected = words[Math.floor(Math.random()*words.length)];

            db.ref("lobbies/"+lobbyId).update({
                state: "game",
                word: selected.word,
                hint: mode === "hint" ? selected.hint : "",
                impostor: impostor,
                mode: mode
            });

        });
    });
}

// GAME VIEW
function startGameView(data){
    show("game");

    let wordBox = document.getElementById("word");

    if(playerId === data.impostor){
        wordBox.classList.add("impostor");

        if(data.mode === "hint" && data.hint){
            wordBox.innerText = "IMPOSTOR\nPodpowiedź: " + data.hint;
        }else{
            wordBox.innerText = "IMPOSTOR";
        }

    }else{
        wordBox.classList.remove("impostor");
        wordBox.innerText = data.word;
    }

    document.getElementById("newRoundBtn").style.display = isHost ? "block" : "none";
}

// LEAVE
function leaveGame(){
    if(lobbyId){
        db.ref("lobbies/"+lobbyId+"/players/"+playerId).remove();
    }
    location.reload();
}
</script>

</body>
</html>